<!-- Generated by `caesium job schema --doc` -->
# Job Definition Schema

This document is generated from the job definition Go structs (`pkg/jobdef`). It highlights the required sections and key fields.

## Top-Level Fields

| Field | Type | Required | Notes |
|-------|------|----------|-------|
| `$schema` | string | optional | JSON schema reference for tooling. |
| `apiVersion` | string | required | Must be `v1`. |
| `kind` | string | required | Must be `Job`. |
| `metadata` | object | required | Includes alias, labels, annotations. |
| `trigger` | object | required | Defines how the job is invoked. |
| `callbacks` | array | optional | Notification hooks executed after runs. |
| `steps` | array | required | Ordered list of atoms/tasks forming the DAG. |

## Metadata

| Field | Type | Required | Notes |
|-------|------|----------|-------|
| `alias` | string | required | Unique identifier used across APIs and console. |
| `labels` | map[string]string | optional | Attach metadata for filtering. |
| `annotations` | map[string]string | optional | Free-form metadata surfaced to clients. |

## Trigger

Supported trigger types: `cron`, `http`. Each type accepts a `configuration` map that is persisted verbatim.

### Cron Trigger
| Field | Type | Required | Notes |
|-------|------|----------|-------|
| `cron` | string | required | POSIX cron spec (5 field). |
| `timezone` | string | optional | Defaults to `UTC`. |

### HTTP Trigger
| Field | Type | Required | Notes |
|-------|------|----------|-------|
| `path` | string | required | Route served under `/v1/jobs/:id`. |
| `secret` | string | optional | Shared secret validated by console/API clients. |

## Callbacks

Currently the `notification` callback is supported. Custom handlers consume the JSON payload via the callbacks table.

## Steps

Each step represents a DAG node backed by a task/atom pair. Steps default to the Docker engine when the `engine` field is omitted. When neither `next` nor `dependsOn` is provided, the importer links steps sequentially.

| Field | Type | Required | Notes |
|-------|------|----------|-------|
| `name` | string | required | Unique within the job; used for DAG references. |
| `engine` | string | optional | One of `docker`, `podman`, `kubernetes`. Defaults to `docker`. |
| `image` | string | required | Container image reference. |
| `command` | array[string] | optional | Executed command; defaults to entrypoint. |
| `env` | map[string]string | optional | Environment variables injected into the container. |
| `workdir` | string | optional | Working directory set for the container process. |
| `mounts` | array[Mount] | optional | Bind mounts that make host paths available inside the container. |
| `next` | array[string] | optional | Successor steps triggered when this step completes. Accepts either a string or list in manifests. |
| `dependsOn` | array[string] | optional | Predecessor steps that must complete before this step can run. |

### Mount

| Field | Type | Required | Notes |
|-------|------|----------|-------|
| `type` | string | optional | Currently `bind` is supported (default). |
| `source` | string | required | Host path exposed to the container. |
| `target` | string | required | Mount point inside the container. |
| `readOnly` | bool | optional | When true, the container receives a read-only view. |

## Secret References

Use `secret://` URIs for sensitive values. Supported providers: `env`, `k8s`, `vault`. See `docs/job-definitions.md` for details.
